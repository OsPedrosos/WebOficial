<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Duelo - Brigada dos H√∫medos</title>
    <link href="https://fonts.googleapis.com/css2?family=Chewy&display=swap" rel="stylesheet">
    
    <style>
        /* --- ESTILOS GENERALES DEL JUEGO --- */
        body {
            margin: 0;
            padding: 0;
            overflow: hidden; 
            background-color: #2c3e50; 
            font-family: 'Segoe UI', sans-serif;
            transition: background-color 0.5s ease; 
            user-select: none; 
            -webkit-user-select: none;
            touch-action: none; 
        }

        /* üü¢ NUEVO CONTENEDOR: Selector Fijo Arriba */
        #selector-container {
            position: fixed; /* Fijo para que no se mueva */
            top: 10px;
            left: 50%;
            transform: translateX(-50%); /* Centrado horizontal */
            z-index: 100; 
            padding: 10px 20px;
            border-radius: 10px;
            background: rgba(0, 0, 0, 0.4); /* Fondo semi-transparente */
            color: white;
            font-family: 'Segoe UI', sans-serif;
            pointer-events: auto; /* Permite interacciones */
            font-size: 16px;
        }

        /* Contenedor de instrucciones (Vuelve al centro) */
        #instrucciones {
            position: absolute;
            /* üî¥ REVERSI√ìN: Volver al centro */
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%); 
            
            color: rgba(255, 255, 255, 0.5);
            font-size: 24px;
            text-align: center;
            /* No necesita pointer-events: auto; porque el selector ya no est√° aqu√≠ */
            pointer-events: none; /* Dejar que los toques pasen a las huellas */
            font-family: "Chewy", system-ui;
            z-index: 50; 
        }
        
        /* Asegurar que las huellas no cubran el selector */
        #instrucciones p {
            pointer-events: none;
        }

        /* --- ESTILOS DE LOS C√çRCULOS (HUELLAS) --- */
        .huella {
            position: absolute;
            width: 100px;
            height: 100px;
            border-radius: 50%;
            border: 8px solid white;
            transform: translate(-50%, -50%) scale(0); 
            animation: aparecer 0.3s forwards cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 0 30px rgba(255,255,255,0.2);
            z-index: 10;
        }

        /* Animaci√≥n de latido mientras esperan */
        .huella.esperando {
            animation: latido 1s infinite alternate;
        }

        /* Estilo para la huella ganadora */
        .huella.ganador {
            background-color: white;
            box-shadow: 0 0 50px white;
            transform: translate(-50%, -50%) scale(1.3);
            border-color: white;
            z-index: 20;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        /* Animaci√≥n de entrada */
        @keyframes aparecer {
            to { transform: translate(-50%, -50%) scale(1); }
        }

        /* Animaci√≥n de espera */
        @keyframes latido {
            from { transform: translate(-50%, -50%) scale(0.9); opacity: 0.8; }
            to { transform: translate(-50%, -50%) scale(1.1); opacity: 1; }
        }

        /* Bot√≥n para volver al inicio */
        .btn-volver {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(0,0,0,0.3);
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            text-decoration: none;
            z-index: 100;
            font-weight: bold; 
        }
    </style>
</head>
<body>
    
    <div id="selector-container">
        <label for="numGanadores">N¬∫ de üèÜ:</label>
        <select id="numGanadores" style="padding: 5px; border-radius: 5px; font-size: 18px; color: #34495e;">
            <option value="1">1 üèÜ</option>
            <option value="2">2 üèÜ</option>
            <option value="3">3 üèÜ</option>
            <option value="4">4 üèÜ</option>
            <option value="5">5 üèÜ</option>
        </select>
    </div>

    <div id="instrucciones">
        <p>Colocad los dedos en la pantalla</p>
        <p style="font-size: 16px;">(M√≠nimo 2 jugadores)</p>
    </div>


    <script>
        // --- CONFIGURACI√ìN ---
        const TIEMPO_ESPERA = 3000; // 3 segundos
        const COLORES = ['#e74c3c', '#3498db', '#2ecc71', '#f1c40f', '#9b59b6', '#e67e22', '#1abc9c', '#ff006e'];
        
        // --- VARIABLES DE ESTADO ---
        let toquesActivos = {}; 
        let temporizador = null;
        let juegoTerminado = false;

        // Elementos del DOM
        const body = document.body;
        const instrucciones = document.getElementById('instrucciones');
        const selectorGanadores = document.getElementById('numGanadores'); 

        // --- MANEJO DE EVENTOS T√ÅCTILES ---

        document.addEventListener('touchstart', (e) => {
            e.preventDefault(); 
            if (juegoTerminado) {
                reiniciarJuego(); 
                return;
            }

            for (let i = 0; i < e.changedTouches.length; i++) {
                const toque = e.changedTouches[i];
                crearHuella(toque);
            }

            verificarInicioJuego();

        }, { passive: false });

        const removerToque = (e) => {
            e.preventDefault();
            for (let i = 0; i < e.changedTouches.length; i++) {
                const toque = e.changedTouches[i];
                eliminarHuella(toque.identifier);
            }
            
            if (!juegoTerminado) {
                clearTimeout(temporizador);
                temporizador = null;
                body.style.backgroundColor = '#2c3e50'; 
                instrucciones.style.display = 'block';
                
                // üî¥ SIMPLIFICADO: Ya no necesitamos recrear el selector, solo los mensajes
                instrucciones.innerHTML = '<p>¬°No levant√©is los dedos!</p><p style="font-size: 16px;">(M√≠nimo 2 jugadores)</p
